# 网络粘贴板 App 需求文档（Tauri + Rust）
## 一、项目概述
### 1.1 项目目标
开发一款 **跨平台网络粘贴板工具**，基于 Tauri + Rust 技术栈，支持 Windows、macOS、Linux（桌面端）及 iOS/Android（移动端，基于 Tauri Mobile beta），核心功能为多设备间文本内容同步共享，搭配简单密码认证机制，保障数据安全，同时追求轻量化、易用性与高性能。

### 1.2 核心价值
- 跨设备无缝同步：手机、电脑等多端快速共享文本（如链接、代码片段、备注等）；
- 安全可控：密码认证 + 传输/存储加密，防止内容泄露；
- 轻量化体验：启动快、操作简，无冗余功能，专注粘贴板核心需求；
- 离线可用：本地缓存历史内容，联网后自动同步。

### 1.3 目标用户
需要跨设备快速共享文本的用户（如程序员、办公人群、学生），注重数据安全性，无需复杂功能，追求简洁高效。

## 二、核心功能需求
### 2.1 用户认证模块（简单密码体系）
| 功能点 | 详细描述 | 优先级 |
|--------|----------|--------|
| 初始密码设置 | 首次启动 App 时引导用户设置初始密码（≥6位，支持数字/字母/符号，需二次确认），提供密码强度提示 | 高 |
| 密码登录 | 非首次启动时，需输入密码验证后方可访问功能，支持“显示/隐藏密码”切换 | 高 |
| 密码修改 | 登录后可修改密码，需验证旧密码，新密码需二次确认，修改后即时生效 | 中 |
| 自动锁定 | 后台运行/无操作 5 分钟后自动返回登录页，需重新输入密码解锁（可在设置中关闭） | 中 |
| 密码找回 | 简化设计：不支持邮箱找回，仅提供“重置密码”选项（需删除本地缓存数据，谨慎操作） | 低 |

### 2.2 粘贴板核心功能
| 功能点 | 详细描述 | 优先级 |
|--------|----------|--------|
| 文本输入/粘贴 | 支持手动输入、本地粘贴板导入，字数限制 ≤10 万字符（防止超大内容影响性能） | 高 |
| 一键同步 | 点击“同步”按钮，将当前输入的文本上传至服务端，支持“覆盖最新”或“新增条目”两种模式（默认新增） | 高 |
| 历史记录管理 | 展示所有同步过的文本条目，包含「时间戳+内容预览（前20字符）+操作按钮」，支持按时间倒序排序 | 高 |
| 历史操作 | 每条历史条目支持：①复制到本地粘贴板 ②查看完整内容 ③删除（本地+服务端同步删除） | 高 |
| 本地缓存 | 离线时可查看本地缓存的历史记录，联网后自动同步服务端最新数据（避免重复同步） | 中 |
| 自动同步 | 支持配置“打开 App 时自动同步”“网络切换时自动同步”（默认开启，可在设置中关闭） | 中 |
| 内容搜索 | 支持按关键词搜索历史记录（匹配内容预览/完整文本） | 低 |

### 2.3 跨端同步模块
| 功能点 | 详细描述 | 优先级 |
|--------|----------|--------|
| 服务端配置 | 支持自定义服务端地址（HTTP/HTTPS，优先强制 HTTPS），默认提供演示服务端（注明“仅用于测试，建议自建”） | 高 |
| 传输加密 | 所有网络请求采用 TLS 1.3 加密，防止中间人攻击，服务端 API 仅接受认证后的请求 | 高 |
| 冲突解决 | 多端同时修改同一内容时，以“最新修改时间戳”为准，自动覆盖旧数据（无复杂合并逻辑，保证简洁） | 中 |
| 同步状态提示 | 顶部展示“同步中/同步成功/同步失败”状态，失败时提供重试按钮及错误原因（如网络异常、服务端不可用） | 中 |
| 多端登录 | 同一密码可在多设备登录，实时同步所有历史记录（无设备数量限制） | 高 |

### 2.4 安全模块
| 功能点 | 详细描述 | 优先级 |
|--------|----------|--------|
| 密码加密存储 | 客户端不存储明文密码，采用 bcrypt 算法（工作因子=12）存储密码哈希，防止本地数据泄露 | 高 |
| 内容加密存储 | 服务端存储的文本内容采用 AES-256-GCM 加密，密钥由用户密码派生（服务端无法解密原始内容） | 高 |
| 本地数据加密 | 客户端本地缓存的历史记录、配置信息，通过系统原生加密机制保护（Windows DPAPI / macOS Keychain / Linux libsecret） | 中 |
| 敏感操作确认 | 删除所有历史记录、重置密码等敏感操作，需二次弹窗确认，防止误操作 | 中 |

### 2.5 设置模块
| 功能点 | 详细描述 | 优先级 |
|--------|----------|--------|
| 服务端管理 | 输入自定义服务端 URL，提供“测试连接”按钮，验证地址可用性 | 高 |
| 数据管理 | ①清除本地缓存 ②导出历史记录（JSON/TXT 格式） ③导入历史记录（支持 JSON 格式） | 中 |
| 外观设置 | 支持浅色/深色模式自动切换（跟随系统），可选手动切换 | 中 |
| 同步设置 | 开关“自动同步”“后台同步”功能，调整自动锁定时长 | 中 |
| 关于页面 | 展示 App 版本号、更新检查、开源协议（如 MIT）、联系方式 | 低 |

## 三、非功能需求
### 3.1 兼容性
- 桌面端：Windows 10+、macOS 11+、Linux（Ubuntu 20.04+/Debian 11+/Fedora 36+）；
- 移动端：iOS 14+、Android 10+（基于 Tauri Mobile beta，注明“部分机型可能存在兼容性问题”）；
- 浏览器：无（原生 App，不依赖浏览器）。

### 3.2 性能
- 启动速度：桌面端 ≤3 秒，移动端 ≤5 秒；
- 同步响应：网络良好时（≥1Mbps），同步请求响应时间 ≤1 秒；
- 历史加载：100 条以内历史记录加载时间 ≤0.5 秒；
- 资源占用：桌面端后台运行内存 ≤50MB，移动端 ≤30MB。

### 3.3 易用性
- 核心操作（输入/粘贴/同步/复制）最多 2 步完成；
- 支持快捷键：Ctrl+S（同步）、Ctrl+C（复制选中历史）、Esc（关闭弹窗）；
- 界面简洁：无广告、无冗余功能入口，视觉焦点集中在输入区和历史列表；
- 错误提示：同步失败、密码错误等场景，提供明确可操作的提示（如“网络异常，请检查连接”）。

### 3.4 可靠性
- 数据不丢失：本地缓存 + 服务端存储双重备份，删除操作需二次确认；
- 离线可用：离线时可查看本地缓存的历史记录，支持复制操作，联网后自动同步；
- 服务端容错：服务端不可用时，App 正常展示本地数据，不崩溃；
- 自动备份：每周自动备份本地历史记录到用户指定目录（默认 ~/Documents/剪贴板备份）。

### 3.5 安全性
- 禁止明文传输：所有网络请求强制 HTTPS（自定义服务端 HTTP 时给出安全警告）；
- 密码防护：防止暴力破解（连续 5 次密码错误，锁定 1 分钟）；
- 加密算法合规：使用行业标准加密算法（bcrypt、AES-256-GCM、TLS 1.3），不自定义加密逻辑；
- 隐私保护：不收集用户设备信息、粘贴内容等敏感数据，仅在本地和用户指定服务端存储数据。

## 四、技术栈选型
| 模块         | 技术选型                                                                 |
|--------------|--------------------------------------------------------------------------|
| 前端（Tauri） | Tauri 2.x、TypeScript 5.x、Vue 3（或 React 18）、Tailwind CSS（样式）     |
| 后端（Rust）  | Rust 1.75+、Axum 0.7+（Web 框架）、SQLite 3（默认数据库，支持切换 PostgreSQL） |
| 加密         | ring（加密算法库）、bcrypt（密码哈希）、aes-gcm（内容加密）                |
| 网络         | reqwest（HTTP 客户端）、tokio（异步运行时）、rustls（TLS 实现）            |
| 本地存储     | tauri-plugin-store（配置存储）、diesel（数据库 ORM）                      |
| 辅助工具     | tauri-plugin-notification（同步通知）、tauri-plugin-authenticator（可选生物识别） |

## 五、界面原型概要（文字描述）
### 5.1 登录页
- 顶部：App 图标 + 标题“网络粘贴板” + 副标题“跨端同步 · 安全共享”；
- 中间：密码输入框（带“显示/隐藏”图标）、“登录”按钮（默认禁用，输入≥6字符启用）；
- 底部：“首次使用？设置密码”链接、“配置服务端”入口、“忘记密码？”提示（点击跳转重置说明）。

### 5.2 主页面
- 顶部导航栏：左侧“网络粘贴板”标题、中间同步状态（同步中/成功/失败）、右侧“设置”图标；
- 输入区域：大尺寸多行输入框（占位符“输入或粘贴内容...”），底部显示字数统计；
- 操作栏：“复制到本地”“清空输入”“同步当前内容”三个按钮（同步按钮带加载动画）；
- 历史记录区：标题“历史记录”（可折叠），列表项包含「时间戳 + 内容预览 + 复制按钮 + 删除按钮」；
- 底部状态栏：在线/离线状态、最后同步时间、当前设备名称。

### 5.3 设置页面
- 分组1：服务端配置 → 输入框（服务端 URL）、“测试连接”按钮、“保存”按钮；
- 分组2：账户安全 → “修改密码”按钮、自动锁定时长滑块（0-10分钟，默认5分钟）；
- 分组3：数据管理 → “清除本地缓存”“导出历史记录”“导入历史记录”按钮；
- 分组4：外观设置 → 浅色/深色模式切换（跟随系统/手动选择）；
- 分组5：关于 → 版本号、“检查更新”按钮、开源协议链接、联系方式。

## 六、用户流程
### 6.1 首次使用流程
启动 App → 引导设置初始密码（二次确认）→ 进入主页面 → 输入/粘贴内容 → 点击“同步”→ 内容加密上传至服务端 → 其他设备登录同一密码 → 自动同步内容 → 复制到本地粘贴板。

### 6.2 常规使用流程
启动 App → 输入密码登录 → 主页面自动同步服务端最新数据 → 查看历史记录/输入新内容 → 同步/复制操作 → 后台运行/关闭 App（自动锁定）。

### 6.3 离线使用流程
离线状态启动 App → 登录后展示本地缓存历史 → 支持复制/查看操作 → 输入新内容（仅本地缓存）→ 联网后自动同步新内容至服务端。

## 七、开发计划（分阶段）
| 阶段       | 周期   | 核心任务                                                                 |
|------------|--------|--------------------------------------------------------------------------|
| 阶段1：基础架构 | 1-2周  | 1. Tauri 前端项目初始化（Vue/React 集成、界面原型开发）；2. Rust 后端 API 开发（认证、CRUD 接口）；3. 数据库设计（SQLite）；4. 加密模块集成（密码哈希、内容加密）。 |
| 阶段2：核心功能 | 2-3周  | 1. 用户认证功能（设置密码、登录、自动锁定）；2. 粘贴板输入/同步/本地缓存；3. 历史记录管理（展示、复制、删除）；4. 跨端同步基础功能（服务端连接、数据传输）。 |
| 阶段3：增强与优化 | 1-2周 | 1. 同步策略优化（自动同步、冲突解决）；2. 安全加固（暴力破解防护、本地数据加密）；3. 设置模块开发（服务端配置、数据管理、外观设置）；4. 快捷键支持、错误提示优化。 |
| 阶段4：测试与适配 | 1-2周 | 1. 多平台编译（Windows/macOS/Linux/移动端）；2. 兼容性测试（重点测试桌面端，移动端抽样测试）；3. 性能优化（启动速度、内存占用）；4. 漏洞测试（加密逻辑、网络传输）。 |
| 阶段5：发布与文档 | 1周    | 1. 打包多平台安装包；2. 编写用户手册、服务端自建部署文档；3. 部署演示服务端；4. 发布测试版本，收集用户反馈。 |

## 八、风险与注意事项
1. **Tauri Mobile 兼容性**：移动端基于 Tauri Mobile beta，需明确告知用户“部分机型可能存在功能异常”，优先保障桌面端体验；
2. **服务端依赖**：默认提供演示服务端，但需提示用户“演示服务端仅用于测试，敏感内容建议自建服务端”，并提供详细的自建部署文档；
3. **同步冲突**：简化冲突解决逻辑（按时间戳覆盖），需在用户手册中说明，避免用户误解；
4. **密码安全**：提醒用户设置强密码，避免使用简单密码（如 123456），并告知“密码丢失无法找回，需重置并删除本地数据”；
5. **性能优化**：移动端需控制内存占用，避免后台运行时被系统强制杀死，需优化本地缓存清理逻辑。

## 九、后续可扩展功能（可选）
1. 支持小文件同步（≤10MB，如图片、文档）；
2. 多语言支持（中文、英文）；
3. 生物识别登录（指纹/面容 ID，基于 tauri-plugin-authenticator）；
4. 内容分类标签（给历史记录打标签，支持按标签筛选）；
5. 定时过期功能（设置粘贴内容自动过期时间，过期后自动删除）；
6. 团队共享（多用户密码，支持协作共享粘贴板）。